<ion-header id="header-object-list">
    <ion-navbar color="header-element">
        <ion-title>
            {{ pageTitle }}
        </ion-title>
    </ion-navbar>
</ion-header>

<ion-content  class="page_object_list" >
    <ion-refresher (ionRefresh)="loadContent()"
                   [closeDuration]="400"
                   [pullMin]="150">
        <ion-refresher-content id="refresher-content"
                               pullingIcon="arrow-down"
                               pullingText="{{ 'sync.pull_to_sync' | translate:[] }}"
                               refreshingText="{{checkPageState({loadingLive: true}) ? footerToolbar.loadingText : footerToolbarOfflineContent.loadingText}}"
                               text-center>
        </ion-refresher-content>
    </ion-refresher>

    <!-- status : synchronization in progress, refresher not pulled -->
    <ion-grid *ngIf="checkPageState({refreshing: false}) && (checkPageState({favorites: false, loadingLive: true}) || checkPageState({favorites: true, loadingOffline: true}))">
        <ion-row>
            <ion-col>
                <ion-spinner class="centered"></ion-spinner>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col>
                <ion-label text-center>{{checkPageState({loadingLive: true}) ? footerToolbar.loadingText : footerToolbarOfflineContent.loadingText}}</ion-label>
            </ion-col>
        </ion-row>
    </ion-grid>


  <!-- status : display object-list, synchronization complete -->
  <ion-list  class="ilias-object-list" *ngIf="checkPageState({favorites: false, online: true, loadingLive: false}) || checkPageState({favorites: true, loadingOffline: false})">
    <div class="" *ngIf="parent != undefined">
      <ion-item  no-lines *ngIf="parent.hasPageLayout" text-wrap="" (click)="openPageLayout()" color="list-element" class="list-element">
        <ion-avatar item-start>
            <img [src]="pageLayout.icon"><!-- TODO make relative? -->
        </ion-avatar>
        <span>{{pageLayout.text | translate: []}}</span>
      </ion-item>

      <ion-item no-lines  *ngIf="parent.hasTimeline" text-wrap="" (click)="openTimeline()" color="list-element" class="list-element">
        <ion-icon [name]=timeline.icon item-start></ion-icon>
        <span>{{timeline.text | translate: []}}</span>
      </ion-item>
    </div>
    <ion-item-group>
    <!-- <ion-list-header no-lines color="light-blue" class="list-header-item"> -->
    <!-- <ion-item-divider color="light"> -->
      <!-- {{"object-list.content" | translate: []}} -->
    <!-- </ion-item-divider> -->
    <!-- </ion-list-header> -->

            <button ion-item text-wrap class="bottom-line list-element" *ngFor="let object of objects" (click)="onClick(object)" color="list-element">

                <ion-avatar item-start>
                    <img [src]="object.presenter.icon()"><!-- TODO make relative? -->
                    <ion-badge *ngIf="object.isLinked()" color="nobg-w" class="badge-link">
                        <img [src]="theme.getAsset('icon/obj_link.svg')" class="badge-logo">
                    </ion-badge>
                </ion-avatar>

                <span *ngIf="object.presenter.showTypeAsText()">{{ object.presenter.typeLangVar() | translate:[] }}:</span>
                {{ object.presenter.title() }} <span *ngIf="!object.presenter.title()">{{ 'no_title' | translate:[] }}</span>
                <!--<p class="object-flags">
                    <ion-badge color="light" *ngIf="object.isFavorite">
                        <ion-icon color="primary" name="ai-favorites"></ion-icon>
                    </ion-badge>
                    <ion-badge color="light" *ngIf="object.isFavorite === 2">
                        <ion-icon color="primary" name="download"></ion-icon>
                    </ion-badge>
                </p>-->
                <button ion-button icon-only item-end clear *ngIf="!object.isFavorite" (click)="executeMarkOrUnmarkAsFavoriteAction(object, true);$event.stopPropagation();">
                    <ion-icon name="star-outline" color="primary"></ion-icon>
                </button>
                <button ion-button icon-only item-end clear *ngIf="object.isFavorite === 1" (click)="executeMarkOrUnmarkAsFavoriteAction(object, false);$event.stopPropagation();">
                    <ion-icon name="star" color="primary"></ion-icon>
                </button>
                <button ion-button icon-only item-end clear *ngIf="object.isFavorite === 2" (click)="$event.stopPropagation()">
                    <ion-icon name="download" color="primary"></ion-icon>
                </button>
                <button ion-button icon-only item-end clear (click)="showActions(object);$event.stopPropagation();">
                    <ion-icon name="ios-more" color="primary"></ion-icon>
                </button>
                <!--<button class="ilias-list-action-button" ion-button round color="light" item-right (click)="showActions(object)">
                    <ion-icon name="more" color="primary"></ion-icon>
                </button>-->
            </button>

            <ion-item text-wrap="" *ngIf="!objects.length">
                {{ 'no_items' | translate:[] }}
            </ion-item>
        </ion-item-group>
    </ion-list>

    <!-- status : user offline, not in favorites -->
    <ion-grid *ngIf="checkPageState({favorites: false, online: false})">
        <ion-row>
            <ion-col>
                <ion-label>{{ 'object-list.offline' | translate:[] }}</ion-label>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col>
                <button ion-button (click)="switchToFavoritesTab()">{{ 'favorites.title' | translate:[] }}</button>
            </ion-col>
        </ion-row>
    </ion-grid>

</ion-content>

<!-- <ion-footer >
  <ion-toolbar>
    <ion-buttons left>
      <button ion-button>
        <ion-spinner [paused]="!footerToolbar.isLoading" *ngIf="footerToolbar.isLoading"></ion-spinner>
      </button>
    </ion-buttons>
    <div *ngIf="footerToolbar.isLoading">{{ footerToolbar.loadingText }}</div>
    <div *ngIf="!footerToolbar.isLoading">{{ 'sync.last_sync' | translate:[] }}: {{ sync.lastSyncString }}</div>
  </ion-toolbar>
</ion-footer> -->
